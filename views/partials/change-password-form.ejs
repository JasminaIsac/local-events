<div id="passwordForm" data-show="<%= errors || success ? 'true' : 'false' %>" style="margin-bottom: 2rem; width: 100%;">
  <form action="/profile/change-password" method="POST" class="form-container" style="max-width: 100%; margin: 0; border: 2px solid #ffcb96;">
    <h4 style="margin-top: 0;">SchimbÄƒ parola</h4>
    
    <div class="form-group">
      <label for="currentPassword">Parola curentÄƒ</label>
      <div class="password-wrapper">
        <input 
          type="password" 
          id="currentPassword" 
          name="currentPassword" 
          placeholder="Parola curentÄƒ"
          value="<%= formData.currentPassword || '' %>"
          class="<%= errors?.currentPassword ? 'errorInput' : '' %>"
          required>
        <button type="button" 
          onclick="togglePasswordField('currentPassword', this)" 
          class="password-toggle-btn">
            <i id="icon1" class="fa-solid fa-eye"></i>
        </button>
      </div>
      <% if (errors?.currentPassword) { %>
        <p class="error"><%= errors.currentPassword %></p>
      <% } %>
    </div>
    
    <div class="form-group">
      <label for="newPassword">Parola nouÄƒ</label>
      <div class="password-wrapper">
        <input 
          type="password" 
          id="newPassword" 
          name="newPassword" 
          placeholder="Parola trebuie sÄƒ aibÄƒ 8-16 caractere, literÄƒ mare, literÄƒ micÄƒ, cifrÄƒ È™i simbol" 
          value="<%= formData.newPassword || '' %>"
          class="<%= errors?.newPassword ? 'errorInput' : '' %>"
          required>
        <button type="button" 
          onclick="togglePasswordField('newPassword', this)" 
          class="password-toggle-btn">
            <i id="icon2" class="fa-solid fa-eye"></i>
        </button>
      </div>
      <% if (errors?.newPassword) { %>
        <p class="error"><%= errors.newPassword %></p>
      <% } %>
    </div>
    
    <div class="form-group">
      <label for="confirmNewPassword">ConfirmÄƒ parola nouÄƒ</label>
      <div class="password-wrapper">
        <input 
          type="password" 
          id="confirmNewPassword" 
          name="confirmNewPassword" 
          placeholder="ConfirmÄƒ parola nouÄƒ"
          value="<%= formData.confirmNewPassword || '' %>"
          class="<%= errors?.confirmNewPassword ? 'errorInput' : '' %>"
          required>
        <button type="button" 
          onclick="togglePasswordField('confirmNewPassword', this)" 
          class="password-toggle-btn">
            <i id="icon3" class="fa-solid fa-eye"></i>
        </button>
      </div>
      <% if (errors?.confirmNewPassword) { %>
        <p class="error"><%= errors.confirmNewPassword %></p>
      <% } %>
    </div>
    
    <% if (success) { %>
      <div style="background: #d4edda; color: #155724; padding: 0.75rem; border-radius: 5px; margin-bottom: 1rem;">
        <%= success %>
      </div>
    <% } %>
    
    <%- include('button', {
      type: 'submit',
      label: 'SalveazÄƒ parola',
      icon: 'ðŸ’¾',
      extraClass: 'btn-primary'
    }) %>
    
    <%- include('button', {
      type: 'button',
      label: 'AnuleazÄƒ',
      icon: 'âŒ',
      onclick: 'togglePasswordForm()',
      extraClass: 'btn-logout',
    }) %>
  </form>
</div>

<script>
function togglePasswordField(inputId, btnElement) {
  const passwordInput = document.getElementById(inputId);
  const toggleIcon = btnElement.querySelector("i");

  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    toggleIcon.classList.replace('fa-eye', 'fa-eye-slash');
  } else {
    passwordInput.type = 'password';
    toggleIcon.classList.replace('fa-eye-slash', 'fa-eye');
  }
}
</script>
