<%- include('partials/header', { 
  title: isEdit ? 'Editare eveniment' : 'Adaugare eveniment' 
}) %>

<div class="form-container">
  <h2 class="form-title"><%= title %></h2>

  <form class="event-form" action="<%= isEdit ? '/events/' + event.id + '?_method=PUT' : '/events/add/new' %>" method="POST" enctype="multipart/form-data">
    <div class="form-group">
      <label for="title">Titlu</label>
      <input type="text" name="title" id="title" value="<%= event.title || '' %>" placeholder="Ex: Concert Rock Ã®n centrul oraÈ™ului" required class="<%= errors?.title ? 'errorInput' : '' %>">
      <% if (errors?.title) { %>
        <p class="error"><%= errors.title %></p>
      <% } %>
    </div>


    <div class="form-group">
      <label for="description">Descriere</label>
      <textarea name="description" id="description" rows="4" placeholder="Ex: Vino sÄƒ te distrezi cu muzicÄƒ live È™i atmosferÄƒ plÄƒcutÄƒ!" required class="<%= errors?.description ? 'errorInput' : '' %>"><%= event.description || '' %></textarea>
      <% if (errors?.description) { %>
        <p class="error"><%= errors.description %></p>
      <% } %>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="date">Data</label>
        <input type="date" name="date" id="date" 
          value="<%= event.date ? new Date(event.date).toISOString().split('T')[0] : '' %>" 
          min="<%= new Date().toISOString().split('T')[0] %>"
          required 
          class="<%= errors?.date ? 'errorInput' : '' %>"
        >
        <% if (errors?.date) { %>
          <p class="error"><%= errors.date %></p>
        <% } %>
      </div>
      <div class="form-group">
        <label for="time">Ora</label>
        <input type="time" name="time" id="time" value="<%= event.time || '' %>" required class="<%= errors?.time ? 'errorInput' : '' %>">
        <% if (errors?.time) { %>
          <p class="error"><%=  errors.time %></p>
        <% } %>
      </div>
    </div>

    <div class="form-group">
      <label for="location">LocaÈ›ie</label>
      <input type="text" name="location" id="location" value="<%= event.location || '' %>" placeholder="Ex: Sala PolivalentÄƒ, ChiÈ™inÄƒu" required class="<%= errors?.location ? 'errorInput' : '' %>">
      <% if (errors?.location) { %>
        <p class="error"><%= errors.location %></p>
      <% } %>    
    </div>

    <div class="form-group">
      <label for="categoryId">Categorie</label>
      <select name="categoryId" id="categoryId" required class="<%= errors?.category ? 'errorInput' : '' %>">
        <option value="">SelecteazÄƒ o categorie</option>
        <% categories.forEach(cat => { %>
          <option value="<%= cat.id %>" <%= event.categoryId === cat.id ? 'selected' : '' %>>
            <%= cat.name %>
          </option>
        <% }) %>
      </select>
      <% if (errors?.category) { %>
        <p class="error"><%= errors.category %></p>
      <% } %>    
    </div>

    <div class="form-group">
      <label for="organizer">Organizator</label>
      <input type="text" id="organizer" name="organizer" placeholder="Ex: PrimÄƒria ChiÈ™inÄƒu / Event.md" value="<%= event.organizer || '' %>" required class="<%= errors?.organizer ? 'errorInput' : '' %>">
      <% if (errors?.organizer) { %>
        <p class="error"><%= errors.organizer %></p>
      <% } %>    
    </div>

    <div class="form-group">
      <label for="price">PreÈ›</label>
      <input type="text" id="price" name="price" placeholder="Ex: 150" required value="<%= event.price || '' %>" class="<%= errors?.price ? 'errorInput' : '' %>">
      <small class="form-text">Format: numÄƒr (ex: 100, 50.50), Moneda: (MDL, EUR, RON, USD, GBP, CHF) sau 'Gratuit'.</small>
      <% if (errors?.price) { %>
        <p class="error"><%= errors.price %></p>
      <% } %>
    </div>
    
    <div class="form-group">
      <label for="image">Imagine eveniment</label>

      <div style="display: flex; gap: 1rem;">
        <% if (event?.image) { %>
          <div class="current-image">
            <img src="/images/<%= event.image %>" alt="Imagine eveniment" class="preview-image">
          </div>
        <% } %>

        <% if (event?.image) { %>
          <input type="hidden" name="existingImage" value="<%= event.image %>">
        <% } %>

        <input type="file" name="image" id="image" accept="image/*" class="<%= errors?.image ? 'errorInput' : '' %>" style="width: 100%;">      
        <% if (errors?.image) { %>
          <p class="error"><%= errors.image %></p>
        <% } %>
      </div>
      
      <small class="form-text">Formate acceptate: JPG, PNG, GIF. Max 6MB.</small>
    </div>

    <% if (errors?.form) { %>
      <p class="error"><%=  errors.form %></p>
    <% } %>

    <%- include('partials/button', {
      type: 'submit',
      label: isEdit ? 'ðŸ’¾ SalveazÄƒ modificÄƒrile' : 'AdaugÄƒ Eveniment',
      icon: 'âž•',
      extraClass: 'btn-primary'
    }) %>
  </form>

  <%- include('partials/link', {
    href: '/events',
    label: 'ÃŽnapoi la listÄƒ',
    icon: 'â† ',
    extraClass: ''
  }) %>
</div>


<%- include('partials/footer') %>
